machine:
  environment:
    JAVA_OPTS: "-Xms512m -Xmx1024m -XX:PermSize=64m -XX:MaxPermSize=256m"
  java:
    version: oraclejdk8

# to assist in circleci caching maven dependencies
dependencies:
  override:
    - mvn --fail-never dependency:go-offline || true

test:
  override:
    - mvn clean test -Dspring.profiles.active=circleci
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - find . -type f -regex ".*/target/surefire-reports/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;
    - mkdir -p $CIRCLE_TEST_REPORTS/jacoco/
    - cp -Rv ./target/site/jacoco/ $CIRCLE_TEST_REPORTS/;


